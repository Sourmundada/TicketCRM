{% extends 'base.html' %}

{% block title %}View Ticket | TicketSystem{% endblock title %}

{% block content %}
    
        <div class="card mx-auto" style="max-width: 380px; margin-top:100px;">
          <div class="card-body">
          <h4 class="card-title mb-4">View Ticket</h4>
          <p><b>Ticket:</b> {{ ticket.name }}</p>
          <hr>
          <p>{{ ticket.description|safe }}</p>
          <hr>
          <p><b>Assigned To:</b> {{ ticket.assigned_to.full_name }}</p>
      <hr>
          <p><b>Status:</b> {{ ticket.status }}</p>
      <hr>
      
      {% for file in attachments %}
      <iframe src="{{ file }}" frameborder="0"></iframe>
      {% endfor %}

          <p><b>Attachment: </b> <a href="{% url 'add_attachments' ticket.id  %}" class="btn btn-primary">+ Add Attachments</a></p>

          <hr>

          {% if user.is_admin %}
          <form method="POST" action="{% url 'delete_ticket' ticket.id %}">
            {% csrf_token %}
          <a href="{% url 'update_ticket' ticket.id %}" class="btn btn-primary">Update Ticket</a>
          <button type="submit" class="btn btn-danger">Delete Ticket</button>
        </form>
        
        {% else %}

        {% if ticket.status == 'Completed' or ticket.status == 'Archived' %}
        <h5>This Ticket is Completed.</h5>
        {% else %}
        <form method="POST">
          {% csrf_token %}
          <select name="status">

            <option value="Ongoing">Ongoing</option>
            <option value="Completed">Completed</option>
          </select>
          <button type="submit" class="btn btn-primary">Update Status</button>
        </form>
        {% endif %}
        
        {% endif %}

          </div> <!-- card-body.// -->
        </div> <!-- card .// -->




{% endblock content %}